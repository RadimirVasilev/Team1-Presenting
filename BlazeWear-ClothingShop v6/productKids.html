<!doctype html>
<html lang="bg">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Blaze Wear</title>

  <link rel="stylesheet" href="css/global.css">
  <link rel="stylesheet" href="css/kids.css">
  <link rel="stylesheet" href="css/product.css">
  <link rel="stylesheet" href="css/cart.css">
  <link rel="stylesheet" href="css/payment.css">
  <link rel="stylesheet" href="css/sizeChart.css">

  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
</head>
<body>

  <header class="site-header">
    <div class="header-inner">
      <div class="header-left">
        <a href="ClothingShop.html" class="brand">
          <img src="https://i.postimg.cc/QthCGNqV/logo.png" alt="Blaze Wear logo"
               class="logo-img" height="36" width="36">
          <span class="logo-text">Blaze Wear</span>
        </a>
      </div>

      <div class="header-center">
        <div class="nav-shell">
          <nav class="nav nav-primary" aria-label="Main Sections">
            <ul>
              <li><a href="men.html">–ú—ä–∂–µ</a></li>
              <li><a href="women.html">–ñ–µ–Ω–∏</a></li>
              <li><a href="kids.html">–î–µ—Ü–∞</a></li>
              <li><a href="index.html">–ù–∞—á–∞–ª–æ</a></li>
            </ul>
          </nav>

          <nav class="nav nav-secondary" aria-label="Category Navigation">
            <ul>
              <li><a href="shop.html">–ù–æ–≤–∏</a></li>
              <li class="has-dropdown has-mega">
                <a href="#">–î—Ä–µ—Ö–∏</a>
                <div class="mega-menu">
                  <div class="mega-col">
                    <h4>–ì–æ—Ä–Ω–∏</h4>
                    <a href="#">–°—É–∏—Ç—à—ä—Ä—Ç–∏</a>
                    <a href="#">–Ø–∫–µ—Ç–∞</a>
                    <a href="#">–ë–ª—É–∑–∫–∏</a>
                  </div>
                  <div class="mega-col">
                    <h4>–î–æ–ª–Ω–∏</h4>
                    <a href="#">–ü–∞–Ω—Ç–∞–ª–æ–Ω–∏</a>
                    <a href="#">–ê–Ω—Ü—É–∑–∏</a>
                    <a href="#">–ö–ª–∏–Ω—á–µ—Ç–∞</a>
                  </div>
                  <div class="mega-col">
                    <h4>–°–ø–µ—Ü–∏–∞–ª–Ω–∏</h4>
                    <a href="#">School Essentials</a>
                    <a href="#">Mini Streetwear</a>
                    <a href="#">–ò–≥—Ä–∏ &amp; —Å–ø–æ—Ä—Ç</a>
                  </div>
                </div>
              </li>
              <li class="has-dropdown has-mega">
                <a href="#">–û–±—É–≤–∫–∏</a>
                <div class="mega-menu">
                  <div class="mega-col">
                    <h4>–ú–∞—Ä–∞—Ç–æ–Ω–∫–∏</h4>
                    <a href="#">Everyday</a>
                    <a href="#">–°–ø–æ—Ä—Ç</a>
                  </div>
                  <div class="mega-col">
                    <h4>–ë–æ—Ç–∏</h4>
                    <a href="#">–ó–∏–º–∞</a>
                    <a href="#">–î—ä–∂–¥–æ–≤–Ω–∏</a>
                  </div>
                  <div class="mega-col">
                    <h4>–û—â–µ</h4>
                    <a href="#">–í—Å–∏—á–∫–∏ –æ–±—É–≤–∫–∏</a>
                  </div>
                </div>
              </li>
              <li class="has-dropdown has-mega">
                <a href="#">–ê–∫—Å–µ—Å–æ–∞—Ä–∏</a>
                <div class="mega-menu">
                  <div class="mega-col">
                    <h4>–®–∞–ø–∫–∏ &amp; —Ä—ä–∫–∞–≤–∏—Ü–∏</h4>
                    <a href="#">–®–∞–ø–∫–∏</a>
                    <a href="#">–†—ä–∫–∞–≤–∏—Ü–∏</a>
                  </div>
                  <div class="mega-col">
                    <h4>–†–∞–Ω–∏—Ü–∏</h4>
                    <a href="#">–£—á–∏–ª–∏—â–µ</a>
                    <a href="#">–°–ø–æ—Ä—Ç</a>
                  </div>
                  <div class="mega-col">
                    <h4>–û—â–µ</h4>
                    <a href="#">–¶—è–ª–∞—Ç–∞ –∫–æ–ª–µ–∫—Ü–∏—è</a>
                  </div>
                </div>
              </li>
              <li><a href="#">–°–ø–æ—Ä—Ç</a></li>
              <li><a href="#" class="nav-sale">–†–∞–∑–ø—Ä–æ–¥–∞–∂–±–∞</a></li>
            </ul>
          </nav>
        </div>
      </div>

      <div class="header-right">
        <button class="icon-btn" aria-label="search">üîç</button>
        <button class="icon-btn cart-btn" id="cartOpenBtn" aria-label="cart">
          üõí
          <span class="cart-badge" id="cartBadge" style="display:none;">0</span>
        </button>
      </div>
    </div>
  </header>

  <main class="product-main">
    <div class="product-breadcrumbs">
      <a href="ClothingShop.html" class="crumb-link">–ù–∞—á–∞–ª–æ</a>
      <span class="crumb-sep">/</span>
      <a href="kids.html" class="crumb-link">–î–µ—Ü–∞</a>
      <span class="crumb-sep">/</span>
      <span id="backCrumb" class="crumb-link crumb-prev">–ü—Ä–µ–¥–∏—à–µ–Ω –ø—Ä–æ–¥—É–∫—Ç</span>
    </div>

    <div class="product-container">
      <section class="product-gallery">
        <div class="product-main-image">
          <img id="productMainImage"
               src="https://via.placeholder.com/700x900/1f1140/ffffff?text=Kids+Product"
               alt="Blaze –ø—Ä–æ–¥—É–∫—Ç" />
        </div>

        <div class="product-thumbs">
          <button class="thumb is-active" data-img="https://via.placeholder.com/700x900/1f1140/ffffff?text=Kids+Product" aria-label="–û—Å–Ω–æ–≤–Ω–∞ —Å–Ω–∏–º–∫–∞">
            <img src="https://via.placeholder.com/90x120/1f1140/ffffff?text=A" alt="–û—Å–Ω–æ–≤–Ω–∞ —Å–Ω–∏–º–∫–∞">
          </button>
          <button class="thumb" data-img="https://via.placeholder.com/700x900/0e0a1b/ffffff?text=Alt+View" aria-label="–ê–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–µ–Ω –∏–∑–≥–ª–µ–¥">
            <img src="https://via.placeholder.com/90x120/0e0a1b/ffffff?text=B" alt="–ê–ª—Ç–µ—Ä–Ω–∞—Ç–∏–≤–µ–Ω –∏–∑–≥–ª–µ–¥">
          </button>
        </div>
      </section>

      <section class="product-info-panel">
        <p class="product-brand">MINI BLAZE</p>
        <h1 class="product-title">–ü—Ä–æ–¥—É–∫—Ç</h1>

        <div class="product-price-row">
          <span class="product-price-current">0.00 –ª–≤</span>
          <span class="product-price-old">0.00 –ª–≤</span>
          <span class="product-discount">-0%</span>
        </div>

        <div class="product-option-block">
          <span class="option-label">–†–∞–∑–º–µ—Ä</span>
          <div class="size-options">
            <button class="size-option is-active" data-size="XS">XS</button>
            <button class="size-option" data-size="S">S</button>
            <button class="size-option" data-size="M">M</button>
            <button class="size-option" data-size="L">L</button>
          </div>
          <a href="#" class="size-chart-link">–¢–∞–±–ª–∏—Ü–∞ —Å —Ä–∞–∑–º–µ—Ä–∏</a>
        </div>

        <button id="productAddToCart" class="product-add-btn">–î–æ–±–∞–≤–∏ –≤ –∫–æ–ª–∏—á–∫–∞—Ç–∞</button>

        <section class="product-details">
          <h2>–î–µ—Ç–∞–π–ª–∏ –∑–∞ –ø—Ä–æ–¥—É–∫—Ç–∞</h2>
          <ul>
            <li>–û–ø–∏—Å–∞–Ω–∏–µ 1</li>
            <li>–û–ø–∏—Å–∞–Ω–∏–µ 2</li>
            <li>–û–ø–∏—Å–∞–Ω–∏–µ 3</li>
          </ul>
        </section>
      </section>
    </div>

    <section class="product-reco">
      <div class="product-reco-header">
        <h2>–ú–æ–∂–µ –¥–∞ –≤–∏ —Ö–∞—Ä–µ—Å–∞</h2>
      </div>
      <div class="product-reco-grid"></div>
    </section>
  </main>

  <aside id="cartPanel" class="shop-cart-panel" aria-hidden="true">
    <div class="cart-header">
      <h3>–í–∞—à–∞—Ç–∞ –∫–æ–ª–∏—á–∫–∞</h3>
      <button id="cartClose" class="cart-close" aria-label="–ó–∞—Ç–≤–æ—Ä–∏">√ó</button>
    </div>
    <div id="cartContents" class="cart-contents">
      <p class="cart-empty">–í –º–æ–º–µ–Ω—Ç–∞ –∫–æ–ª–∏—á–∫–∞—Ç–∞ –µ –ø—Ä–∞–∑–Ω–∞</p>
    </div>
    <div class="cart-footer">
      <div class="cart-sum">–û–±—â–æ: <strong id="cartTotal">0.00 –ª–≤</strong></div>
      <button id="checkoutBtn" class="cart-checkout">–ö—É–ø–∏ —Å–µ–≥–∞</button>
    </div>
  </aside>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div class="footer-left">
        <span class="logo-icon">üî•</span> <strong>BlazeWear</strong> ‚Äî All rights reserved
      </div>
      <div class="footer-center">
        <nav class="footer-nav">
          <a href="ClothingShop.html">–ù–∞—á–∞–ª–æ</a> ¬∑
          <a href="about.html">–û—Ç–Ω–æ—Å–Ω–æ</a> ¬∑
          <a href="shop.html">–ú–∞–≥–∞–∑–∏–Ω</a>
        </nav>
      </div>
      <div class="footer-right">
        <div class="contacts">
          <div>contact@blazewear.example</div>
          <div>+359 88 000 0000</div>
        </div>
      </div>
    </div>
  </footer>

  <div id="paymentModal" class="payment-modal" aria-hidden="true">
    <div class="payment-modal-backdrop" data-close="true"></div>

    <div class="payment-modal-panel" role="dialog" aria-modal="true" aria-labelledby="pmTitle">
      <button type="button" class="pm-close" aria-label="–ó–∞—Ç–≤–æ—Ä–∏">√ó</button>
      <h3 id="pmTitle">–ü–ª–∞—â–∞–Ω–µ</h3>

      <div id="pmSavedWrapper" class="pm-saved" style="display:none;">
        <span id="pmSavedLabel"></span>
        <button type="button" id="useSavedCardBtn" class="pm-btn-secondary pm-btn-small">–ò–∑–ø–æ–ª–∑–≤–∞–π —Ç–∞–∑–∏ –∫–∞—Ä—Ç–∞</button>
      </div>

      <form id="paymentForm">
        <label for="pmethod">–ú–µ—Ç–æ–¥ –Ω–∞ –ø–ª–∞—â–∞–Ω–µ</label>
        <select id="pmethod" name="pmethod">
          <option value="">–ò–∑–±–µ—Ä–∏ –º–µ—Ç–æ–¥‚Ä¶</option>
          <option value="visa">Visa</option>
          <option value="mastercard">Mastercard</option>
          <option value="amex">American Express</option>
        </select>

        <label for="cardNumber">–ù–æ–º–µ—Ä –Ω–∞ –∫–∞—Ä—Ç–∞</label>
        <input id="cardNumber" name="cardNumber" type="text" inputmode="numeric" autocomplete="cc-number" placeholder="1234 5678 9012 3456" />

        <div class="pm-row">
          <div class="pm-col small">
            <label for="expMonth">–ú–µ—Å–µ—Ü</label>
            <select id="expMonth" name="expMonth">
              <option value="">–ú–µ—Å–µ—Ü</option>
            </select>
          </div>

          <div class="pm-col small">
            <label for="expYear">–ì–æ–¥–∏–Ω–∞</label>
            <select id="expYear" name="expYear">
              <option value="">–ì–æ–¥–∏–Ω–∞</option>
            </select>
          </div>

          <div class="pm-col small">
            <label for="cardCvc">CVC</label>
            <input id="cardCvc" name="cardCvc" type="password" inputmode="numeric" autocomplete="cc-csc" placeholder="123" />
          </div>
        </div>

        <div class="pm-actions">
          <button type="submit" class="pm-btn-primary">–ü–æ—Ç–≤—ä—Ä–¥–∏ –ø–ª–∞—â–∞–Ω–µ—Ç–æ</button>
          <button id="saveCardBtn" class="pm-btn-secondary">–ó–∞–ø–∞–∑–∏ –∫–∞—Ä—Ç–∞—Ç–∞</button>
        </div>

        <div id="pmMessage" class="pm-message"></div>
      </form>
    </div>
  </div>

  <script src="js/productKids.js"></script>

  <script>
  document.addEventListener('DOMContentLoaded', () => {
    // –∞–∫—Ç–∏–≤–µ–Ω –ª–∏–Ω–∫ "–î–µ—Ü–∞"
    document.querySelectorAll('.nav a').forEach(a => {
      if (a.getAttribute('href') === 'kids.html') a.classList.add('active');
    });

    const backCrumb = document.getElementById('backCrumb');
    if (backCrumb) backCrumb.addEventListener('click', () => window.history.back());

    const params = new URLSearchParams(window.location.search);
    const productId = params.get('id') || 'kids-1';

    const kidsProducts = (window.BLAZE_PRODUCTS && window.BLAZE_PRODUCTS.kids) || {};
    const productData = kidsProducts[productId];

    const mainImg     = document.getElementById('productMainImage');
    const titleEl     = document.querySelector('.product-title');
    const brandEl     = document.querySelector('.product-brand');
    const priceEl     = document.querySelector('.product-price-current');
    const oldPriceEl  = document.querySelector('.product-price-old');
    const discountEl  = document.querySelector('.product-discount');
    const detailsList = document.querySelector('.product-details ul');

    let currentSize = 'XS';

    if (productData) {
      if (mainImg) { mainImg.src = productData.mainImage; mainImg.alt = productData.name; }
      if (titleEl) titleEl.textContent = productData.name;
      if (brandEl && productData.brand) brandEl.textContent = productData.brand;

      document.title = 'Blaze Wear ‚Äì ' + productData.name;

      const initialPrice = (productData.sizes && productData.sizes['XS']) || productData.price;
      if (priceEl) priceEl.textContent = Number(initialPrice).toFixed(2) + ' –ª–≤';

      if (productData.oldPrice && oldPriceEl && discountEl) {
        oldPriceEl.style.display = 'inline';
        discountEl.style.display = 'inline';
        oldPriceEl.textContent = Number(productData.oldPrice).toFixed(2) + ' –ª–≤';
        discountEl.textContent = productData.discount || '';
      } else {
        if (oldPriceEl) oldPriceEl.style.display = 'none';
        if (discountEl) discountEl.style.display = 'none';
      }

      if (detailsList && Array.isArray(productData.details)) {
        detailsList.innerHTML = '';
        productData.details.forEach(d => {
          const li = document.createElement('li');
          li.textContent = d;
          detailsList.appendChild(li);
        });
      }
    } else {
      console.warn('–ù—è–º–∞ –¥–µ—Ñ–∏–Ω–∏—Ä–∞–Ω –ø—Ä–æ–¥—É–∫—Ç –∑–∞ id =', productId);
    }

    const thumbs = document.querySelectorAll('.product-thumbs .thumb');
    thumbs.forEach(btn => {
      btn.addEventListener('click', () => {
        thumbs.forEach(b => b.classList.remove('is-active'));
        btn.classList.add('is-active');
        const img = btn.dataset.img || '';
        if (mainImg && img) mainImg.src = img;
      });
    });

    const sizeBtns = document.querySelectorAll('.size-option');
    sizeBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        sizeBtns.forEach(b => b.classList.remove('is-active'));
        btn.classList.add('is-active');
        currentSize = btn.dataset.size;

        if (productData && productData.sizes && productData.sizes[currentSize]) {
          const newPrice = productData.sizes[currentSize];
          if (priceEl) priceEl.textContent = Number(newPrice).toFixed(2) + ' –ª–≤';
        }
      });
    });

    const addToCartBtn = document.getElementById('productAddToCart');
    if (addToCartBtn) {
      addToCartBtn.addEventListener('click', () => {
        if (!productData) return;

        const priceForSize = (productData.sizes && productData.sizes[currentSize]) || productData.price;

        const cartItem = {
          id: productId + '-' + currentSize,
          name: productData.name + ' (' + currentSize + ')',
          price: priceForSize,
          img: productData.mainImage,
          qty: 1,
          size: currentSize,
          productId: productId,
          category: productData.category || null
        };

        document.dispatchEvent(new CustomEvent('cart:add', { detail: cartItem }));

        addToCartBtn.textContent = '‚úì –î–æ–±–∞–≤–µ–Ω–æ!';
        setTimeout(() => addToCartBtn.textContent = '–î–æ–±–∞–≤–∏ –≤ –∫–æ–ª–∏—á–∫–∞—Ç–∞', 2000);

        updateCartBadge();
      });
    }

    function updateCartBadge() {
      const badge = document.getElementById('cartBadge');
      if (!badge) return;

      const cartData = localStorage.getItem('cart');
      let totalQty = 0;

      if (cartData) {
        try {
          const cart = JSON.parse(cartData) || {};
          Object.keys(cart).forEach(id => totalQty += Number(cart[id]?.qty) || 0);
        } catch(e) { totalQty = 0; }
      }

      if (totalQty > 0) {
        badge.textContent = totalQty;
        badge.style.display = 'inline-block';
      } else {
        badge.textContent = '0';
        badge.style.display = 'none';
      }
    }
    document.addEventListener('cart:updated', updateCartBadge);
    updateCartBadge();

    const cartOpenBtn = document.getElementById('cartOpenBtn');
    const cartPanel   = document.getElementById('cartPanel');
    const cartClose   = document.getElementById('cartClose');

    if (cartOpenBtn && cartPanel) cartOpenBtn.addEventListener('click', () => cartPanel.setAttribute('aria-hidden', 'false'));
    if (cartClose && cartPanel)   cartClose.addEventListener('click', () => cartPanel.setAttribute('aria-hidden', 'true'));

    document.addEventListener('click', (e) => {
      if (cartPanel && cartOpenBtn && !cartPanel.contains(e.target) && !cartOpenBtn.contains(e.target)) {
        cartPanel.setAttribute('aria-hidden', 'true');
      }
    });

    const recoGrid = document.querySelector('.product-reco-grid');
    function renderRecommendations() {
      if (!recoGrid || !productData) return;
      recoGrid.innerHTML = '';

      const entries = Object.entries(kidsProducts || {});
      if (!entries.length) return;

      const currentCat = productData.category || null;

      let recos = entries.filter(([id, p]) => id !== productId && p.category === currentCat);
      if (recos.length < 4) {
        const extra = entries.filter(([id, p]) => id !== productId && p.category !== currentCat);
        recos = recos.concat(extra);
      }

      recos.slice(0, 4).forEach(([id, p]) => {
        const card = document.createElement('article');
        card.className = 'product-card';
        const basePrice = p.price || (p.sizes && p.sizes.XS) || 0;

        card.innerHTML = `
          <a href="productKids.html?id=${id}" class="product-card-link">
            <div class="product-card-thumb">
              <img src="${p.mainImage}" alt="${p.name}">
            </div>
            <div class="product-card-info">
              <h3>${p.name}</h3>
              <span class="product-card-price">${Number(basePrice).toFixed(2)} –ª–≤</span>
            </div>
          </a>
        `;
        recoGrid.appendChild(card);
      });
    }
    renderRecommendations();

    const sizeChartLink   = document.querySelector('.size-chart-link');
    const sizeModal       = document.getElementById('sizeModal');
    const sizeModalBack   = sizeModal ? sizeModal.querySelector('.size-modal-backdrop') : null;
    const sizeModalClose  = sizeModal ? sizeModal.querySelector('.size-modal-close') : null;

    function openSizeModal() {
      if (!sizeModal) return;
      sizeModal.setAttribute('aria-hidden', 'false');

      const clothesChart = document.getElementById('sizeChartClothes');
      const shoesChart   = document.getElementById('sizeChartShoes');

      if (clothesChart && shoesChart) {
        clothesChart.classList.remove('active');
        shoesChart.classList.remove('active');

        const cat = (productData && (productData.category || '') || '').toLowerCase();
        if (cat === 'shoes' || cat === '–æ–±—É–≤–∫–∏') shoesChart.classList.add('active');
        else clothesChart.classList.add('active');
      }
    }
    function closeSizeModal() {
      if (!sizeModal) return;
      sizeModal.setAttribute('aria-hidden', 'true');
    }

    if (sizeChartLink) sizeChartLink.addEventListener('click', (e) => { e.preventDefault(); openSizeModal(); });
    if (sizeModalBack) sizeModalBack.addEventListener('click', closeSizeModal);
    if (sizeModalClose) sizeModalClose.addEventListener('click', closeSizeModal);
  });
  </script>

  <script src="js/script.js"></script>
  <script src="js/cart.js"></script>

      <div id="sizeChartShoes" class="size-chart">
        <table>
          <thead>
            <tr>
              <th>–î—ä–ª–∂–∏–Ω–∞ –Ω–∞ —Å—Ç—ä–ø–∞–ª–æ—Ç–æ (—Å–º)</th>
              <th>EU</th>
              <th>US</th>
              <th>UK</th>
            </tr>
          </thead>
          <tbody>
            <tr><td>15.2</td><td>25</td><td>8</td><td>7</td></tr>
            <tr><td>16.0</td><td>26</td><td>9</td><td>8</td></tr>
            <tr><td>16.7</td><td>27</td><td>10</td><td>9</td></tr>
            <tr><td>17.3</td><td>28</td><td>11</td><td>10</td></tr>
            <tr><td>18.0</td><td>29</td><td>12</td><td>11</td></tr>
            <tr><td>18.7</td><td>30</td><td>13</td><td>12</td></tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

</body>
</html>
